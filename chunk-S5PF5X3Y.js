import{a as F}from"./chunk-ZDOUOYXW.js";import"./chunk-HQUAAR4S.js";import{Bb as N,Eb as f,Fb as h,Ka as s,Mb as _,Oa as d,Ua as L,Ya as m,cb as P,cc as E,db as a,dc as y,e as c,eb as I,ec as T,gb as l,hb as n,hc as w,jb as S,ka as g,kb as C,la as b,lb as p,rb as r,sb as v,tb as x,ub as D}from"./chunk-XZRIOFSC.js";var R=()=>["d\xE9butant","interm\xE9diaire","avanc\xE9","expert"];function j(o,i){if(o&1&&(l(0,"li",11)(1,"div",12)(2,"strong"),r(3),f(4,"titlecase"),n(),l(5,"span"),r(6),n()(),l(7,"small",13),r(8),n()()),o&2){let e=i.$implicit,t=p(2);s(3),v(h(4,3,e)),s(3),v(t.getLevelStatus(t.castLevel(e))),s(2),v(t.levelDescriptions[t.castLevel(e)])}}function U(o,i){if(o&1){let e=S();l(0,"div",1)(1,"h2",2),r(2,"\u{1F579}\uFE0F Syst\xE8me de Points & Niveaux"),n(),l(3,"div",3)(4,"p")(5,"strong"),r(6,"Niveau actuel :"),n(),r(7),f(8,"titlecase"),n(),l(9,"p")(10,"strong"),r(11,"Points :"),n(),r(12),n(),l(13,"div",4)(14,"div",5),r(15),n()(),l(16,"button",6),C("click",function(){g(e);let u=p();return b(u.upgradeLevel())}),r(17," \u{1F53C} Am\xE9liorer mon niveau "),n()(),l(18,"div",7)(19,"h4",8),r(20,"\u{1F513} D\xE9verrouillage des niveaux"),n(),l(21,"ul",9),m(22,j,9,5,"li",10),n()()()}if(o&2){let e=p();s(7),x(" ",h(8,10,e.level),""),s(5),D(" ",e.points," / ",e.nextLevelPoints===e.infinity?"\u221E":e.nextLevelPoints,""),s(2),I("width",e.points/e.nextLevelPoints*100+"%"),P("aria-valuenow",e.points)("aria-valuemax",e.nextLevelPoints),s(),x(" ",e.points," pts "),s(),a("disabled",e.nextLevelPoints===e.infinity),s(6),a("ngForOf",N(12,R))}}var O=class o{constructor(i,e){this.userService=i;this.cdr=e}profile=null;points=0;level="d\xE9butant";nextLevelPoints=0;infinity=Number.POSITIVE_INFINITY;levels=["d\xE9butant","interm\xE9diaire","avanc\xE9","expert"];levelThresholds={d\u00E9butant:0,interm\u00E9diaire:50,avanc\u00E9:250,expert:600};levelDescriptions={d\u00E9butant:"Niveau initial avec peu d\u2019exp\xE9rience",interm\u00E9diaire:"Capable d\u2019agir avec un peu d\u2019autonomie",avanc\u00E9:"Autonome, reconnu pour sa ma\xEEtrise",expert:"R\xE9f\xE9rent, capable de guider les autres"};ngOnInit(){return c(this,null,function*(){this.profile=yield this.userService.getCurrentProfile(),this.profile&&(this.points=this.profile.points,this.level=this.profile.level,this.nextLevelPoints=this.getNextLevelThreshold(this.level))})}getNextLevelThreshold(i){let e=this.levels.indexOf(i);return e>=this.levels.length-1?this.infinity:this.levelThresholds[this.levels[e+1]]}upgradeLevel(){return c(this,null,function*(){let e=this.levels.indexOf(this.level)+1;if(e<this.levels.length){let t=this.levels[e],u=this.levelThresholds[t];this.points>=u?(this.level=t,this.nextLevelPoints=this.getNextLevelThreshold(this.level),yield this.userService.updatePrivateInfo({level:t}),t==="avanc\xE9"&&this.profile?.role==="simple"?(this.profile.role="complexe",yield this.userService.updatePrivateInfo({role:"complexe"}),alert(`\u2705 Niveau mont\xE9 : ${t}. Statut mis \xE0 jour \xE0 complexe.`)):t==="expert"&&this.profile&&this.profile.role!=="admin"?(this.profile.role="admin",yield this.userService.updatePrivateInfo({role:"admin"}),console.log("Role updated to admin"),alert(`\u2705 Niveau mont\xE9 : ${t}. Statut mis \xE0 jour \xE0 admin.`)):alert(`\u2705 Niveau mont\xE9 : ${t}`),this.cdr.detectChanges()):alert("\u274C Pas assez de points.")}})}castLevel(i){return i}getLevelStatus(i){return i===this.level?"\u{1F535} Actuel":this.points>=this.levelThresholds[i]?"\u2705 D\xE9bloqu\xE9":"\u{1F512} Verrouill\xE9"}static \u0275fac=function(e){return new(e||o)(d(F),d(_))};static \u0275cmp=L({type:o,selectors:[["app-points-niveaux"]],decls:1,vars:1,consts:[["class","container mt-4",4,"ngIf"],[1,"container","mt-4"],[1,"text-custom-blue"],[1,"card","p-3","mb-4"],[1,"progress","mb-3"],["role","progressbar","aria-valuemin","0",1,"progress-bar"],[1,"btn","btn-primary",3,"click","disabled"],[1,"card","p-3"],[1,"mb-3"],[1,"list-group"],["class","list-group-item",4,"ngFor","ngForOf"],[1,"list-group-item"],[1,"d-flex","justify-content-between"],[1,"text-muted"]],template:function(e,t){e&1&&m(0,U,23,13,"div",0),e&2&&a("ngIf",t.profile)},dependencies:[w,E,y,T],encapsulation:2})};export{O as PointsNiveauxComponent};
