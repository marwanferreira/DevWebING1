import{d as V}from"./chunk-5DJFR4RE.js";import{a as F}from"./chunk-ZDOUOYXW.js";import{a as O,b as D,c as W,d as R,e as T,f as U,k,l as q}from"./chunk-ZAQOZOOT.js";import{C as I,H as N,w as E}from"./chunk-HQUAAR4S.js";import{Ka as l,Oa as p,Ua as C,Ya as v,db as M,dc as L,e as b,gb as i,hb as o,hc as P,ib as _,jb as h,ka as d,kb as S,la as g,lb as x,rb as r,tb as y,xb as c,yb as u,zb as f}from"./chunk-XZRIOFSC.js";function B(a,m){if(a&1&&(i(0,"div",13),r(1),o()),a&2){let t=x();l(),y(" ",t.errorMessage," ")}}var j=class a{constructor(m,t,e){this.userService=m;this.router=t;this.firestore=e;console.log("Login component loaded")}email="";password="";errorMessage="";login(){return b(this,null,function*(){if(console.log("Login button clicked \u2705"),!(yield this.userService.login(this.email,this.password))){this.errorMessage="Email ou mot de passe incorrect.";return}let t=this.userService.getUserProfile();if(t?.uid){let s=I(this.firestore,"users",t.uid);yield N(s,{lastLogin:new Date().toISOString()})}let e=this.userService.getUser();alert(`Bienvenue ! Vous \xEAtes connect\xE9 en tant que ${e}.`),this.router.navigate(["/"])})}static \u0275fac=function(t){return new(t||a)(p(F),p(V),p(E))};static \u0275cmp=C({type:a,selectors:[["app-login"]],decls:18,vars:3,consts:[["loginForm","ngForm"],[1,"login-page"],[1,"mb-4","text-center"],[1,"bi","bi-box-arrow-in-right"],[1,"login-box"],[3,"ngSubmit"],[1,"mb-3"],["for","email",1,"form-label"],["type","email","id","email","name","email","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","password",1,"form-label"],["type","password","id","password","name","password","required","",1,"form-control",3,"ngModelChange","ngModel"],["class","alert alert-danger",4,"ngIf"],["type","submit",1,"btn-login"],[1,"alert","alert-danger"]],template:function(t,e){if(t&1){let s=h();i(0,"div",1)(1,"h2",2),_(2,"i",3),r(3," Connexion "),o(),i(4,"div",4)(5,"form",5,0),S("ngSubmit",function(){return d(s),g(e.login())}),i(7,"div",6)(8,"label",7),r(9,"Email"),o(),i(10,"input",8),f("ngModelChange",function(n){return d(s),u(e.email,n)||(e.email=n),g(n)}),o()(),i(11,"div",6)(12,"label",9),r(13,"Mot de passe"),o(),i(14,"input",10),f("ngModelChange",function(n){return d(s),u(e.password,n)||(e.password=n),g(n)}),o()(),v(15,B,2,1,"div",11),i(16,"button",12),r(17,"Se connecter"),o()()()()}t&2&&(l(10),c("ngModel",e.email),l(4),c("ngModel",e.password),l(),M("ngIf",e.errorMessage))},dependencies:[P,L,q,U,O,D,W,k,T,R],styles:[".login-page[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;margin-top:70px}.login-page[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:36px;color:#036;margin-bottom:30px;font-weight:700}.login-box[_ngcontent-%COMP%]{background-color:#fff;padding:30px;border-radius:16px;box-shadow:0 15px 40px #0000001a;width:100%;max-width:400px}.btn-login[_ngcontent-%COMP%]{width:100%;background-color:#036;color:#fff;font-weight:600;border:none;padding:12px;border-radius:10px;transition:.3s;margin-top:15px}.btn-login[_ngcontent-%COMP%]:hover{background-color:#001f4d;transform:scale(1.02)}"]})};export{j as LoginComponent};
