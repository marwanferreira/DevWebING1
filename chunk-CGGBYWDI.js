import{a as G}from"./chunk-ZDOUOYXW.js";import{a as T,b as V,e as j,l as F}from"./chunk-ZAQOZOOT.js";import"./chunk-HQUAAR4S.js";import{Cb as y,Ia as x,Ka as r,Oa as b,Ua as S,Ya as _,bc as I,cc as D,db as c,dc as M,e as v,gb as n,hb as e,hc as U,ib as g,jb as E,ka as u,kb as h,la as f,lb as p,rb as i,tb as l,xb as w,yb as P,zb as C}from"./chunk-XZRIOFSC.js";var L=s=>({"border-primary border-3":s});function k(s,o){if(s&1){let t=E();n(0,"img",14),h("click",function(){let a=u(t).$implicit,m=p(2);return f(m.selectAvatar(a))}),e()}if(s&2){let t=o.$implicit,d=p(2);c("src",t,x)("ngClass",y(2,L,d.profile.photoURL===t))}}function O(s,o){if(s&1&&(n(0,"div",15),g(1,"img",16),n(2,"div")(3,"p",17)(4,"strong"),i(5,"Pseudo:"),e(),i(6),e(),n(7,"p",17)(8,"strong"),i(9,"Genre:"),e(),i(10),e(),n(11,"p",17)(12,"strong"),i(13,"Date de naissance:"),e(),i(14),e(),n(15,"p",17)(16,"strong"),i(17,"Type de membre:"),e(),i(18),e(),n(19,"p",17)(20,"strong"),i(21,"Num\xE9ro de chambre:"),e(),i(22),e()()()),s&2){let t=o.$implicit,d=p(2);r(),c("src",t.photoURL||d.defaultPhotoURL,x),r(5),l(" ",t.pseudonym,""),r(4),l(" ",t.gender,""),r(4),l(" ",t.birthdate,""),r(4),l(" ",t.memberType,""),r(4),l(" ",t.roomNumber,"")}}function R(s,o){if(s&1){let t=E();n(0,"div",1)(1,"h2",2),i(2,"\u{1F464} Gestion de Profil"),e(),n(3,"div",3),g(4,"img",4),n(5,"p")(6,"strong"),i(7,"Choisissez un avatar :"),e()(),n(8,"div",5),_(9,k,1,4,"img",6),e(),g(10,"hr"),n(11,"p")(12,"strong"),i(13,"Pseudo:"),e(),i(14),e(),n(15,"p")(16,"strong"),i(17,"Email:"),e(),i(18),e(),n(19,"p")(20,"strong"),i(21,"Role:"),e(),i(22),e(),n(23,"p")(24,"strong"),i(25,"Genre:"),e(),i(26),e(),n(27,"p")(28,"strong"),i(29,"Date de naissance:"),e(),i(30),e(),n(31,"p")(32,"strong"),i(33,"Type de membre:"),e(),i(34),e(),n(35,"p")(36,"strong"),i(37,"Num\xE9ro de chambre:"),e(),i(38),e(),g(39,"hr"),n(40,"div",7)(41,"label")(42,"strong"),i(43,"Nom:"),e()(),n(44,"input",8),C("ngModelChange",function(a){u(t);let m=p();return P(m.profile.name,a)||(m.profile.name=a),f(a)}),e()(),n(45,"div",7)(46,"label")(47,"strong"),i(48,"Pr\xE9nom:"),e()(),n(49,"input",8),C("ngModelChange",function(a){u(t);let m=p();return P(m.profile.surname,a)||(m.profile.surname=a),f(a)}),e()(),n(50,"button",9),h("click",function(){u(t);let a=p();return f(a.savePrivateInfo())}),i(51,"\u{1F4BE} Mettre \xE0 jour infos"),e(),g(52,"hr"),n(53,"div",7)(54,"label")(55,"strong"),i(56,"Nouveau mot de passe:"),e()(),n(57,"input",10),C("ngModelChange",function(a){u(t);let m=p();return P(m.newPassword,a)||(m.newPassword=a),f(a)}),e()(),n(58,"button",11),h("click",function(){u(t);let a=p();return f(a.changePassword())}),i(59,"\u{1F510} Changer le mot de passe"),e()(),n(60,"div",12)(61,"h4"),i(62,"\u{1F465} Profils des autres membres"),e(),_(63,O,23,6,"div",13),e()()}if(s&2){let t=p();r(4),c("src",t.profile.photoURL||t.defaultPhotoURL,x),r(5),c("ngForOf",t.avatarOptions),r(5),l(" ",t.profile.pseudonym,""),r(4),l(" ",t.profile.email,""),r(4),l(" ",t.profile.role,""),r(4),l(" ",t.profile.gender,""),r(4),l(" ",t.profile.birthdate,""),r(4),l(" ",t.profile.memberType,""),r(4),l(" ",t.profile.roomNumber,""),r(6),w("ngModel",t.profile.name),r(5),w("ngModel",t.profile.surname),r(8),w("ngModel",t.newPassword),r(6),c("ngForOf",t.publicProfiles)}}function W(s,o){s&1&&(n(0,"div",1)(1,"p"),i(2,"Chargement du profil..."),e()())}var N=class s{constructor(o){this.userService=o;console.log("\u{1F525} GestionProfilComponent loaded")}profile=null;publicProfiles=[];newPassword="";defaultPhotoURL="https://www.w3schools.com/howto/img_avatar.png";avatarOptions=[this.defaultPhotoURL,"assets/avatars/10491829.jpg","assets/avatars/10491837.jpg","assets/avatars/10491848.jpg","assets/avatars/10491839.jpg","assets/avatars/10491828.jpg","assets/avatars/10496273.jpg","assets/avatars/10496278.jpg","assets/avatars/10496272.jpg","assets/avatars/10491836.jpg","assets/avatars/10491849.jpg","assets/avatars/10491845.jpg"];ngOnInit(){return v(this,null,function*(){console.log("\u26A1 ngOnInit running...");try{this.profile=yield this.userService.getCurrentProfile(),this.publicProfiles=yield this.userService.getPublicProfiles(),this.profile?console.log("\u2705 Profile loaded:",this.profile):console.error("\u274C Profile is null!")}catch(o){console.error("\u274C Error during ngOnInit:",o)}})}selectAvatar(o){return v(this,null,function*(){if(this.profile?.uid)try{yield this.userService.updatePrivateInfo({photoURL:o}),this.profile.photoURL=o,alert("\u2705 Avatar updated!")}catch(t){console.error("\u274C Failed to update avatar:",t)}})}savePrivateInfo(){return v(this,null,function*(){if(this.profile?.uid)try{yield this.userService.updatePrivateInfo({name:this.profile.name,surname:this.profile.surname}),alert("\u2705 Private info updated!")}catch(o){console.error("\u274C Failed to update private info:",o)}})}changePassword(){return v(this,null,function*(){if(!this.newPassword){alert("\u2757 Please enter a new password.");return}try{yield this.userService.updatePassword(this.newPassword),this.newPassword="",alert("\u2705 Password updated!")}catch(o){console.error("\u274C Failed to update password:",o)}})}static \u0275fac=function(t){return new(t||s)(b(G))};static \u0275cmp=S({type:s,selectors:[["app-gestion-profil"]],decls:2,vars:2,consts:[["class","container mt-4",4,"ngIf"],[1,"container","mt-4"],[1,"text-custom-blue"],[1,"card","p-3","mb-4"],["width","100",1,"rounded","mb-3",3,"src"],[1,"d-flex","flex-wrap","gap-2","mb-3"],["width","80","height","80","class","rounded border","style","cursor: pointer",3,"src","ngClass","click",4,"ngFor","ngForOf"],[1,"mb-2"],[1,"form-control",3,"ngModelChange","ngModel"],[1,"btn","btn-primary","btn-sm",3,"click"],["type","password",1,"form-control",3,"ngModelChange","ngModel"],[1,"btn","btn-warning","btn-sm",3,"click"],[1,"card","p-3"],["class","border rounded p-2 mb-2 d-flex align-items-center",4,"ngFor","ngForOf"],["width","80","height","80",1,"rounded","border",2,"cursor","pointer",3,"click","src","ngClass"],[1,"border","rounded","p-2","mb-2","d-flex","align-items-center"],["width","50","height","50",1,"rounded","me-3",3,"src"],[1,"mb-1"]],template:function(t,d){t&1&&_(0,R,64,13,"div",0)(1,W,3,0,"div",0),t&2&&(c("ngIf",d.profile),r(),c("ngIf",!d.profile))},dependencies:[U,I,D,M,F,T,V,j],encapsulation:2})};export{N as GestionProfilComponent};
