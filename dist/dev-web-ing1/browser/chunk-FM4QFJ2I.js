import{a as P}from"./chunk-6YAUY6RG.js";import{a as F}from"./chunk-B2ROMJ5P.js";import{b as O,e as G,h as T,i as A,j as N,l as j}from"./chunk-PI5EMYVM.js";import{Ba as r,Cb as I,Eb as V,Fa as C,Fb as k,Ja as E,Na as _,Ta as c,Va as n,Wa as t,Ya as w,Za as f,_a as p,c as x,cb as i,ea as v,eb as d,fa as g,fb as y,gb as S,hb as b,ib as h,kb as R,lb as M}from"./chunk-6CM4DDM5.js";function W(m,a){if(m&1&&(n(0,"option",15),i(1),t()),m&2){let e=a.$implicit;c("value",e),r(),d(" Chambre ",e," ")}}function $(m,a){if(m&1){let e=w();n(0,"div",2)(1,"h5"),i(2),t(),n(3,"p")(4,"strong"),i(5,"Email :"),t(),i(6),t(),n(7,"p")(8,"strong"),i(9,"Date de naissance :"),t(),i(10),R(11,"date"),t(),n(12,"p")(13,"strong"),i(14,"Genre :"),t(),i(15),t(),n(16,"p")(17,"strong"),i(18,"Type de membre :"),t(),i(19),t(),n(20,"p")(21,"strong"),i(22,"Motivation :"),t(),i(23),t(),n(24,"div",3)(25,"div",4)(26,"label",5),i(27,"R\xF4le"),t(),n(28,"select",6),h("ngModelChange",function(l){let s=v(e).$implicit,u=p();return b(u.selectedRole[s.email],l)||(u.selectedRole[s.email]=l),g(l)}),n(29,"option",7),i(30,"S\xE9lectionner un r\xF4le"),t(),n(31,"option",8),i(32,"Simple"),t(),n(33,"option",9),i(34,"Complexe"),t(),n(35,"option",10),i(36,"Admin"),t()()(),n(37,"div",4)(38,"label",5),i(39,"Chambre"),t(),n(40,"select",6),h("ngModelChange",function(l){let s=v(e).$implicit,u=p();return b(u.selectedRoom[s.email],l)||(u.selectedRoom[s.email]=l),g(l)}),n(41,"option",7),i(42,"Attribuer une chambre"),t(),_(43,W,2,2,"option",11),t()(),n(44,"div",12)(45,"button",13),f("click",function(){let l=v(e).$implicit,s=p();return g(s.approve(l))}),i(46,"\u2705 Accepter"),t(),n(47,"button",14),f("click",function(){let l=v(e).$implicit,s=p();return g(s.reject(l))}),i(48,"\u274C Rejeter"),t()()()()}if(m&2){let e=a.$implicit,o=p();r(2),y("",e.prenom," ",e.nom,""),r(4),d(" ",e.email,""),r(4),d(" ",M(11,12,e.dateNaissance),""),r(5),d(" ",e.genre,""),r(4),d(" ",e.typeMembre,""),r(4),d(" ",e.motivation,""),r(5),S("ngModel",o.selectedRole[e.email]),r(),c("ngValue",null),r(11),S("ngModel",o.selectedRoom[e.email]),r(),c("ngValue",null),r(2),c("ngForOf",o.getAvailableRooms())}}var U=class m{constructor(a,e){this.applicationService=a;this.userService=e}candidatures=[];selectedRole={};selectedRoom={};takenRooms=[];ngOnInit(){return x(this,null,function*(){this.candidatures=yield this.applicationService.getCandidatures(),this.takenRooms=yield this.userService.getTakenRooms()})}getAvailableRooms(){return Array.from({length:10},(e,o)=>o+1).filter(e=>!this.takenRooms.includes(e))}approve(a){return x(this,null,function*(){let e=this.selectedRole[a.email],o=this.selectedRoom[a.email];if(!e){alert("Merci de s\xE9lectionner un r\xF4le.");return}if(!o){alert("Merci de s\xE9lectionner une chambre disponible.");return}if(this.takenRooms.includes(o)){alert("Cette chambre est d\xE9j\xE0 attribu\xE9e.");return}yield this.userService.addUserFromCandidature(a,e,o),yield this.applicationService.deleteCandidature(a.id),this.takenRooms.push(o),alert(`\u2705 ${a.nom} a \xE9t\xE9 accept\xE9 avec le r\xF4le ${e} en chambre ${o}.`),yield this.ngOnInit()})}reject(a){return x(this,null,function*(){yield this.applicationService.deleteCandidature(a.id),alert(`\u274C Candidature de ${a.nom} rejet\xE9e.`),yield this.ngOnInit()})}static \u0275fac=function(e){return new(e||m)(C(P),C(F))};static \u0275cmp=E({type:m,selectors:[["app-gestion-candidatures"]],decls:3,vars:1,consts:[[1,"mb-4"],["class","card mb-3 p-3",4,"ngFor","ngForOf"],[1,"card","mb-3","p-3"],[1,"d-flex","flex-column","flex-md-row","align-items-start","gap-2","mt-3"],[1,"flex-fill"],[1,"form-label"],[1,"form-select",3,"ngModelChange","ngModel"],[3,"ngValue"],["value","simple"],["value","complexe"],["value","admin"],[3,"value",4,"ngFor","ngForOf"],[1,"d-flex","gap-2","mt-2","mt-md-4"],[1,"btn","btn-success",3,"click"],[1,"btn","btn-danger",3,"click"],[3,"value"]],template:function(e,o){e&1&&(n(0,"h2",0),i(1,"Gestion des candidatures"),t(),_(2,$,49,14,"div",1)),e&2&&(r(2),c("ngForOf",o.candidatures))},dependencies:[k,I,V,j,A,N,T,O,G],encapsulation:2})};export{U as a};
